p8105\_hw6\_qw2331
================

## Problem 1

### 1.1 Load the data

``` r
baby_bwt_raw <- 
  read_csv("./data/birthweight.csv")
```

### 1.2 Clean the data

``` r
# Convert numeric to factor
race <- c("White", "Black", "Asian", "Puerto Rican", "Other", "Unkown")

baby_bwt_df <- 
  baby_bwt_raw %>% 
  mutate(
    babysex = factor(recode(babysex, `1` = "male", `2` = "female")),
    malform = factor(recode(malform, `0` = "absent", `1` = "present")),
    frace = factor(race[frace]),
    mrace = factor(race[mrace])
  )
```

### 1.3 Propose a regression model

**1.3.1 Check distribution of target variable `brithweight`**

``` r
baby_bwt_df %>% 
  ggplot(aes(bwt)) + 
  geom_histogram(aes(y = ..density..), fill = "orange", alpha = .6) +
  geom_density(alpha = .4) + 
  labs(
    title = "Density of birthweight",
    x = "Birth Weight (grams)",
    y = "Density"
  )
```

<img src="p8105_hw6_qw2331_files/figure-gfm/unnamed-chunk-1-1.png" width="90%" />

**1.3.2 Summary statistics and check outliers**

``` r
# Check for missing values and a brief data review
summary(baby_bwt_df)
```

    ##    babysex         bhead          blength           bwt           delwt      
    ##  female:2112   Min.   :21.00   Min.   :20.00   Min.   : 595   Min.   : 86.0  
    ##  male  :2230   1st Qu.:33.00   1st Qu.:48.00   1st Qu.:2807   1st Qu.:131.0  
    ##                Median :34.00   Median :50.00   Median :3132   Median :143.0  
    ##                Mean   :33.65   Mean   :49.75   Mean   :3114   Mean   :145.6  
    ##                3rd Qu.:35.00   3rd Qu.:51.00   3rd Qu.:3459   3rd Qu.:157.0  
    ##                Max.   :41.00   Max.   :63.00   Max.   :4791   Max.   :334.0  
    ##     fincome               frace         gaweeks         malform    
    ##  Min.   : 0.00   Asian       :  46   Min.   :17.70   absent :4327  
    ##  1st Qu.:25.00   Black       :1911   1st Qu.:38.30   present:  15  
    ##  Median :35.00   Puerto Rican: 248   Median :39.90                 
    ##  Mean   :44.11   White       :2123   Mean   :39.43                 
    ##  3rd Qu.:65.00   NA's        :  14   3rd Qu.:41.10                 
    ##  Max.   :96.00                       Max.   :51.30                 
    ##     menarche        mheight          momage              mrace     
    ##  Min.   : 0.00   Min.   :48.00   Min.   :12.0   Asian       :  43  
    ##  1st Qu.:12.00   1st Qu.:62.00   1st Qu.:18.0   Black       :1909  
    ##  Median :12.00   Median :63.00   Median :20.0   Puerto Rican: 243  
    ##  Mean   :12.51   Mean   :63.49   Mean   :20.3   White       :2147  
    ##  3rd Qu.:13.00   3rd Qu.:65.00   3rd Qu.:22.0                      
    ##  Max.   :19.00   Max.   :77.00   Max.   :44.0                      
    ##      parity            pnumlbw     pnumsga      ppbmi            ppwt      
    ##  Min.   :0.000000   Min.   :0   Min.   :0   Min.   :13.07   Min.   : 70.0  
    ##  1st Qu.:0.000000   1st Qu.:0   1st Qu.:0   1st Qu.:19.53   1st Qu.:110.0  
    ##  Median :0.000000   Median :0   Median :0   Median :21.03   Median :120.0  
    ##  Mean   :0.002303   Mean   :0   Mean   :0   Mean   :21.57   Mean   :123.5  
    ##  3rd Qu.:0.000000   3rd Qu.:0   3rd Qu.:0   3rd Qu.:22.91   3rd Qu.:134.0  
    ##  Max.   :6.000000   Max.   :0   Max.   :0   Max.   :46.10   Max.   :287.0  
    ##      smoken           wtgain      
    ##  Min.   : 0.000   Min.   :-46.00  
    ##  1st Qu.: 0.000   1st Qu.: 15.00  
    ##  Median : 0.000   Median : 22.00  
    ##  Mean   : 4.145   Mean   : 22.08  
    ##  3rd Qu.: 5.000   3rd Qu.: 28.00  
    ##  Max.   :60.000   Max.   : 89.00

``` r
str(baby_bwt_df)
```

    ## spec_tbl_df [4,342 Ã— 20] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
    ##  $ babysex : Factor w/ 2 levels "female","male": 1 2 1 2 1 2 1 1 2 2 ...
    ##  $ bhead   : num [1:4342] 34 34 36 34 34 33 33 33 36 33 ...
    ##  $ blength : num [1:4342] 51 48 50 52 52 52 46 49 52 50 ...
    ##  $ bwt     : num [1:4342] 3629 3062 3345 3062 3374 ...
    ##  $ delwt   : num [1:4342] 177 156 148 157 156 129 126 140 146 169 ...
    ##  $ fincome : num [1:4342] 35 65 85 55 5 55 96 5 85 75 ...
    ##  $ frace   : Factor w/ 4 levels "Asian","Black",..: 4 2 4 4 4 4 2 4 4 2 ...
    ##  $ gaweeks : num [1:4342] 39.9 25.9 39.9 40 41.6 ...
    ##  $ malform : Factor w/ 2 levels "absent","present": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ menarche: num [1:4342] 13 14 12 14 13 12 14 12 11 12 ...
    ##  $ mheight : num [1:4342] 63 65 64 64 66 66 72 62 61 64 ...
    ##  $ momage  : num [1:4342] 36 25 29 18 20 23 29 19 13 19 ...
    ##  $ mrace   : Factor w/ 4 levels "Asian","Black",..: 4 2 4 4 4 4 2 4 4 2 ...
    ##  $ parity  : num [1:4342] 3 0 0 0 0 0 0 0 0 0 ...
    ##  $ pnumlbw : num [1:4342] 0 0 0 0 0 0 0 0 0 0 ...
    ##  $ pnumsga : num [1:4342] 0 0 0 0 0 0 0 0 0 0 ...
    ##  $ ppbmi   : num [1:4342] 26.3 21.3 23.6 21.8 21 ...
    ##  $ ppwt    : num [1:4342] 148 128 137 127 130 115 105 119 105 145 ...
    ##  $ smoken  : num [1:4342] 0 0 1 10 1 0 0 0 0 4 ...
    ##  $ wtgain  : num [1:4342] 29 28 11 30 26 14 21 21 41 24 ...
    ##  - attr(*, "spec")=
    ##   .. cols(
    ##   ..   babysex = col_double(),
    ##   ..   bhead = col_double(),
    ##   ..   blength = col_double(),
    ##   ..   bwt = col_double(),
    ##   ..   delwt = col_double(),
    ##   ..   fincome = col_double(),
    ##   ..   frace = col_double(),
    ##   ..   gaweeks = col_double(),
    ##   ..   malform = col_double(),
    ##   ..   menarche = col_double(),
    ##   ..   mheight = col_double(),
    ##   ..   momage = col_double(),
    ##   ..   mrace = col_double(),
    ##   ..   parity = col_double(),
    ##   ..   pnumlbw = col_double(),
    ##   ..   pnumsga = col_double(),
    ##   ..   ppbmi = col_double(),
    ##   ..   ppwt = col_double(),
    ##   ..   smoken = col_double(),
    ##   ..   wtgain = col_double()
    ##   .. )
    ##  - attr(*, "problems")=<externalptr>

``` r
# Check outliers using boxplots
pivotdata <- 
  baby_bwt_df %>% 
  select(2:6, 8, 10:12, 17:18, 20) %>% 
  pivot_longer(
    everything(),
    names_to = "variable",
    values_to = "value"
  )

pivotdata %>% 
  ggplot(aes(factor(variable), value)) + 
  geom_boxplot(
    aes(color = variable), 
    show.legend = FALSE, outlier.size = .8) + 
  facet_wrap(~variable, scale = "free") + 
  labs(
    title = "Boxplots of 12 numeric variables",
    x = "Variable",
    y = "Value"
  )
```

<img src="p8105_hw6_qw2331_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />

**1.3.3 Correlation Matrix**

``` r
# Create a correlation matrix
cordata <- 
  baby_bwt_df %>% 
  select(2:6, 8, 10:12, 17:18, 20) %>% 
  cor() %>% 
  round(3)

ggcorrplot::ggcorrplot(
  cordata, type = "lower", hc.order = TRUE, lab = TRUE, lab_size = 3) + 
  guides(
    fill = guide_legend(title = "Pearson\nCorrelation")
  )
```

<img src="p8105_hw6_qw2331_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />
